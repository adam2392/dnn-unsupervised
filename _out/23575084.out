Temp data dir is : /scratch/users/ali39@jhu.edu/data/dnn/temp/test_2dcnn_fragility_notnorm/
Output data dir is: /scratch/users/ali39@jhu.edu/data/dnn/output/test_2dcnn_fragility_notnorm/
Train data dir is: /scratch/users/ali39@jhu.edu/data/dnn/
2
/scratch/users/ali39@jhu.edu/dnn-unsupervised
Running training model

/scratch/users/ali39@jhu.edu/dnn-unsupervisedCreated VGG12 Style CNN_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 32, 32, 1)         0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 30, 30, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 28, 28, 32)        9248      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 26, 26, 32)        9248      
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 24, 24, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 8, 8, 64)          36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 64)          0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 2, 2, 128)         73856     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 1, 1, 128)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               66048     
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 1026      
=================================================================
Total params: 224,418
Trainable params: 224,418
Non-trainable params: 0
_________________________________________________________________
None
None
model input shape is:  (None, 32, 32, 1)
['image_tensor', 'metadata']


 Images and ylabels shapes are: 

(57560, 32, 32, 1)
(57560, 2)


(57560, 32, 32, 1)
Using real-time data augmentation.
Epoch 1/50
 - 29s - loss: 0.5311 - acc: 0.7554 - val_loss: 0.4019 - val_acc: 0.9632
Epoch 2/50
 - 24s - loss: 0.4628 - acc: 0.8038 - val_loss: 0.5121 - val_acc: 0.7727
Epoch 3/50
 - 24s - loss: 0.4406 - acc: 0.8152 - val_loss: 0.3248 - val_acc: 0.9472
Epoch 4/50
 - 24s - loss: 0.4317 - acc: 0.8179 - val_loss: 0.3383 - val_acc: 0.9424
Epoch 5/50
 - 24s - loss: 0.4256 - acc: 0.8216 - val_loss: 0.3118 - val_acc: 0.9579
Epoch 6/50
 - 24s - loss: 0.4216 - acc: 0.8232 - val_loss: 0.2750 - val_acc: 0.9597
Epoch 7/50
 - 24s - loss: 0.4168 - acc: 0.8249 - val_loss: 0.2599 - val_acc: 0.9537
Epoch 8/50
 - 24s - loss: 0.4146 - acc: 0.8259 - val_loss: 0.2053 - val_acc: 0.9709
Epoch 9/50
 - 24s - loss: 0.4119 - acc: 0.8275 - val_loss: 0.1666 - val_acc: 0.9838
Epoch 10/50
 - 24s - loss: 0.4101 - acc: 0.8286 - val_loss: 0.2153 - val_acc: 0.9634
Epoch 11/50
 - 24s - loss: 0.4073 - acc: 0.8294 - val_loss: 0.2715 - val_acc: 0.9462
Epoch 12/50
 - 24s - loss: 0.4059 - acc: 0.8314 - val_loss: 0.1927 - val_acc: 0.9820
Epoch 13/50
 - 24s - loss: 0.4051 - acc: 0.8310 - val_loss: 0.1913 - val_acc: 0.9761
Epoch 14/50
 - 24s - loss: 0.4043 - acc: 0.8309 - val_loss: 0.2222 - val_acc: 0.9705
Epoch 15/50
 - 24s - loss: 0.4002 - acc: 0.8339 - val_loss: 0.2108 - val_acc: 0.9711
Epoch 16/50
 - 24s - loss: 0.4008 - acc: 0.8334 - val_loss: 0.2329 - val_acc: 0.9508
Epoch 17/50
 - 24s - loss: 0.3993 - acc: 0.8344 - val_loss: 0.1655 - val_acc: 0.9818
Epoch 18/50
 - 24s - loss: 0.3980 - acc: 0.8345 - val_loss: 0.2193 - val_acc: 0.9636
Epoch 19/50
 - 24s - loss: 0.3954 - acc: 0.8362 - val_loss: 0.1829 - val_acc: 0.9597
Epoch 20/50
 - 24s - loss: 0.3942 - acc: 0.8356 - val_loss: 0.1837 - val_acc: 0.9672
Epoch 21/50
 - 24s - loss: 0.3945 - acc: 0.8361 - val_loss: 0.1843 - val_acc: 0.9717
Epoch 22/50
 - 24s - loss: 0.3924 - acc: 0.8368 - val_loss: 0.2942 - val_acc: 0.9326
Epoch 23/50
 - 24s - loss: 0.3920 - acc: 0.8381 - val_loss: 0.1782 - val_acc: 0.9775
Epoch 24/50
 - 24s - loss: 0.3910 - acc: 0.8365 - val_loss: 0.1551 - val_acc: 0.9735
Epoch 25/50
 - 24s - loss: 0.3905 - acc: 0.8370 - val_loss: 0.2004 - val_acc: 0.9745
Epoch 26/50
 - 24s - loss: 0.3886 - acc: 0.8389 - val_loss: 0.2463 - val_acc: 0.9561
Epoch 27/50
 - 24s - loss: 0.3883 - acc: 0.8386 - val_loss: 0.2521 - val_acc: 0.9478
Epoch 28/50
 - 24s - loss: 0.3868 - acc: 0.8395 - val_loss: 0.1839 - val_acc: 0.9715
Epoch 29/50
 - 24s - loss: 0.3851 - acc: 0.8411 - val_loss: 0.2053 - val_acc: 0.9575
Epoch 30/50
 - 24s - loss: 0.3846 - acc: 0.8407 - val_loss: 0.1813 - val_acc: 0.9711
Epoch 31/50
 - 24s - loss: 0.3833 - acc: 0.8412 - val_loss: 0.2860 - val_acc: 0.9193
Epoch 32/50
 - 24s - loss: 0.3825 - acc: 0.8416 - val_loss: 0.2606 - val_acc: 0.9290
Epoch 33/50
 - 24s - loss: 0.3839 - acc: 0.8417 - val_loss: 0.2322 - val_acc: 0.9442
Epoch 34/50
 - 24s - loss: 0.3806 - acc: 0.8432 - val_loss: 0.2748 - val_acc: 0.9229
Epoch 35/50
 - 24s - loss: 0.3800 - acc: 0.8431 - val_loss: 0.2095 - val_acc: 0.9515
Epoch 36/50
 - 24s - loss: 0.3786 - acc: 0.8424 - val_loss: 0.2195 - val_acc: 0.9571
Epoch 37/50
 - 24s - loss: 0.3778 - acc: 0.8438 - val_loss: 0.2166 - val_acc: 0.9513
Epoch 38/50
 - 24s - loss: 0.3757 - acc: 0.8455 - val_loss: 0.2415 - val_acc: 0.9377
Epoch 39/50
 - 24s - loss: 0.3756 - acc: 0.8451 - val_loss: 0.1881 - val_acc: 0.9581
Epoch 40/50
 - 24s - loss: 0.3744 - acc: 0.8457 - val_loss: 0.1461 - val_acc: 0.9646
Epoch 41/50
 - 24s - loss: 0.3729 - acc: 0.8481 - val_loss: 0.2242 - val_acc: 0.9391
Epoch 42/50
 - 24s - loss: 0.3722 - acc: 0.8477 - val_loss: 0.1802 - val_acc: 0.9555
Epoch 43/50
 - 24s - loss: 0.3700 - acc: 0.8476 - val_loss: 0.2634 - val_acc: 0.9235
Epoch 44/50
 - 24s - loss: 0.3707 - acc: 0.8480 - val_loss: 0.1860 - val_acc: 0.9571
Epoch 45/50
 - 24s - loss: 0.3696 - acc: 0.8485 - val_loss: 0.2190 - val_acc: 0.9363
Epoch 46/50
 - 24s - loss: 0.3682 - acc: 0.8491 - val_loss: 0.1925 - val_acc: 0.9460
Epoch 47/50
 - 24s - loss: 0.3669 - acc: 0.8498 - val_loss: 0.2122 - val_acc: 0.9347
Epoch 48/50
 - 24s - loss: 0.3642 - acc: 0.8519 - val_loss: 0.2906 - val_acc: 0.8926
Epoch 49/50
 - 24s - loss: 0.3642 - acc: 0.8519 - val_loss: 0.2311 - val_acc: 0.9258
Epoch 50/50
 - 24s - loss: 0.3624 - acc: 0.8507 - val_loss: 0.1666 - val_acc: 0.9595
(4944,)
(4944,)
Mean accuracy score:  0.959546925566343
F1 score: 0.9793559042113955
Recall: 0.9607128392061564
Precision: 0.9987368421052631

 clasification report:
              precision    recall  f1-score   support

          0       0.00      0.00      0.00         6
          1       1.00      0.96      0.98      4938

avg / total       1.00      0.96      0.98      4944


 confusion matrix:
 [[   0    6]
 [ 194 4744]]
