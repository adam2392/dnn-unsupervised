Temp data dir is : /scratch/users/ali39@jhu.edu/data/dnn/temp/test_2dcnn_fragility_notnorm_v2/
Output data dir is: /scratch/users/ali39@jhu.edu/data/dnn/output/test_2dcnn_fragility_notnorm_v2/
Train data dir is: /scratch/users/ali39@jhu.edu/data/dnn/
2
/scratch/users/ali39@jhu.edu/dnn-unsupervised
Running training model

/scratch/users/ali39@jhu.edu/dnn-unsupervisedCreated VGG12 Style CNN_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 32, 32, 1)         0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 30, 30, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 28, 28, 32)        9248      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 26, 26, 32)        9248      
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 24, 24, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 8, 8, 64)          36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 64)          0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 2, 2, 128)         73856     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 1, 1, 128)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               66048     
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 1026      
=================================================================
Total params: 224,418
Trainable params: 224,418
Non-trainable params: 0
_________________________________________________________________
None
None
model input shape is:  (None, 32, 32, 1)
['image_tensor', 'metadata']


 Images and ylabels shapes are: 

(57560, 32, 32, 1)
(57560, 2)


(57560, 32, 32, 1)
Using real-time data augmentation.
1016
2838
(32, 32, 1)
(32, 32, 1)
(57560, 32, 32, 1)
(57560, 2)
(57562, 32, 32, 1)
(57562, 2)
Epoch 1/30
 - 30s - loss: 0.5333 - acc: 0.7534 - val_loss: 0.7770 - val_acc: 0.4379
Epoch 2/30
 - 24s - loss: 0.4631 - acc: 0.8034 - val_loss: 0.8615 - val_acc: 0.4124
Epoch 3/30
 - 24s - loss: 0.4424 - acc: 0.8149 - val_loss: 0.8956 - val_acc: 0.4092
Epoch 4/30
 - 24s - loss: 0.4321 - acc: 0.8175 - val_loss: 0.8456 - val_acc: 0.4211
Epoch 5/30
 - 24s - loss: 0.4251 - acc: 0.8218 - val_loss: 0.9898 - val_acc: 0.4122
Epoch 6/30
 - 24s - loss: 0.4204 - acc: 0.8233 - val_loss: 1.0397 - val_acc: 0.4128
Epoch 7/30
 - 24s - loss: 0.4162 - acc: 0.8245 - val_loss: 1.0449 - val_acc: 0.4134
Epoch 8/30
 - 24s - loss: 0.4135 - acc: 0.8264 - val_loss: 1.0091 - val_acc: 0.4116
Epoch 9/30
 - 24s - loss: 0.4116 - acc: 0.8274 - val_loss: 1.0173 - val_acc: 0.4167
Epoch 10/30
 - 24s - loss: 0.4085 - acc: 0.8293 - val_loss: 0.9712 - val_acc: 0.4282
Epoch 11/30
 - 24s - loss: 0.4066 - acc: 0.8290 - val_loss: 0.9081 - val_acc: 0.4488
Epoch 12/30
 - 24s - loss: 0.4059 - acc: 0.8311 - val_loss: 0.8792 - val_acc: 0.4399
Epoch 13/30
 - 24s - loss: 0.4035 - acc: 0.8319 - val_loss: 1.0093 - val_acc: 0.4134
Epoch 14/30
 - 24s - loss: 0.4031 - acc: 0.8315 - val_loss: 0.9248 - val_acc: 0.4438
Epoch 15/30
 - 24s - loss: 0.4011 - acc: 0.8327 - val_loss: 0.9044 - val_acc: 0.4349
Epoch 16/30
 - 24s - loss: 0.3994 - acc: 0.8333 - val_loss: 0.9564 - val_acc: 0.4217
Epoch 17/30
 - 24s - loss: 0.3982 - acc: 0.8345 - val_loss: 0.9600 - val_acc: 0.4308
Epoch 18/30
 - 24s - loss: 0.3967 - acc: 0.8363 - val_loss: 0.9614 - val_acc: 0.4383
Epoch 19/30
 - 24s - loss: 0.3964 - acc: 0.8350 - val_loss: 0.8957 - val_acc: 0.4331
Epoch 20/30
 - 24s - loss: 0.3949 - acc: 0.8357 - val_loss: 1.0168 - val_acc: 0.4195
Epoch 21/30
 - 24s - loss: 0.3944 - acc: 0.8366 - val_loss: 0.9634 - val_acc: 0.4316
Epoch 22/30
 - 24s - loss: 0.3923 - acc: 0.8373 - val_loss: 0.9675 - val_acc: 0.4308
Epoch 23/30
 - 24s - loss: 0.3909 - acc: 0.8381 - val_loss: 1.0505 - val_acc: 0.4169
Epoch 24/30
 - 24s - loss: 0.3900 - acc: 0.8390 - val_loss: 0.9575 - val_acc: 0.4252
Epoch 25/30
 - 24s - loss: 0.3874 - acc: 0.8392 - val_loss: 0.9436 - val_acc: 0.4239
Epoch 26/30
 - 24s - loss: 0.3886 - acc: 0.8394 - val_loss: 0.9302 - val_acc: 0.4331
Epoch 27/30
 - 24s - loss: 0.3873 - acc: 0.8402 - val_loss: 0.8915 - val_acc: 0.4569
Epoch 28/30
 - 24s - loss: 0.3862 - acc: 0.8405 - val_loss: 0.9974 - val_acc: 0.4306
Epoch 29/30
 - 24s - loss: 0.3853 - acc: 0.8416 - val_loss: 0.9301 - val_acc: 0.4333
Epoch 30/30
 - 24s - loss: 0.3831 - acc: 0.8424 - val_loss: 0.9558 - val_acc: 0.4296
(4944,)
(4944,)
Mean accuracy score:  0.42961165048543687
F1 score: 0.5839480672764827
Recall: 0.9734382685686178
Precision: 0.4170706006322445

 clasification report:
              precision    recall  f1-score   support

          0       0.73      0.05      0.09      2911
          1       0.42      0.97      0.58      2033

avg / total       0.60      0.43      0.30      4944


 confusion matrix:
 [[ 145 2766]
 [  54 1979]]
