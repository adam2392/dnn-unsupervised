Temp data dir is : /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/
Output data dir is: /scratch/users/ali39@jhu.edu/data/dnn/output/2dcnn_fragility_notnorm/
Train data dir is: /scratch/users/ali39@jhu.edu/data/dnn/
0
/scratch/users/ali39@jhu.edu/dnn-unsupervised
Running training model

/scratch/users/ali39@jhu.edu/dnn-unsupervisedCreated VGG12 Style CNN_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 32, 32, 1)         0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 30, 30, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 28, 28, 32)        9248      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 26, 26, 32)        9248      
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 24, 24, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 8, 8, 64)          36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 64)          0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 2, 2, 128)         73856     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 1, 1, 128)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               66048     
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 1026      
=================================================================
Total params: 224,418
Trainable params: 224,418
Non-trainable params: 0
_________________________________________________________________
None
None
model input shape is:  (None, 32, 32, 1)
['image_tensor', 'metadata']


 Images and ylabels shapes are: 

(57560, 32, 32, 1)
(57560, 2)


(57560, 32, 32, 1)
Using real-time data augmentation.
Epoch 1/30

Epoch 00001: val_acc improved from -inf to 0.78837, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-01-0.79.hdf5
 - 30s - loss: 0.5310 - acc: 0.7516 - val_loss: 0.4836 - val_acc: 0.7884
Epoch 2/30

Epoch 00002: val_acc improved from 0.78837 to 0.81406, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-02-0.81.hdf5
 - 26s - loss: 0.4626 - acc: 0.8035 - val_loss: 0.4363 - val_acc: 0.8141
Epoch 3/30

Epoch 00003: val_acc improved from 0.81406 to 0.81911, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-03-0.82.hdf5
 - 26s - loss: 0.4398 - acc: 0.8147 - val_loss: 0.4265 - val_acc: 0.8191
Epoch 4/30

Epoch 00004: val_acc improved from 0.81911 to 0.82111, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-04-0.82.hdf5
 - 26s - loss: 0.4327 - acc: 0.8165 - val_loss: 0.4203 - val_acc: 0.8211
Epoch 5/30

Epoch 00005: val_acc did not improve
 - 26s - loss: 0.4271 - acc: 0.8205 - val_loss: 0.4270 - val_acc: 0.8183
Epoch 6/30

Epoch 00006: val_acc did not improve
 - 25s - loss: 0.4206 - acc: 0.8240 - val_loss: 0.4245 - val_acc: 0.8178
Epoch 7/30

Epoch 00007: val_acc improved from 0.82111 to 0.82706, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-07-0.83.hdf5
 - 26s - loss: 0.4194 - acc: 0.8237 - val_loss: 0.4116 - val_acc: 0.8271
Epoch 8/30

Epoch 00008: val_acc did not improve
 - 25s - loss: 0.4148 - acc: 0.8267 - val_loss: 0.4109 - val_acc: 0.8259
Epoch 9/30

Epoch 00009: val_acc improved from 0.82706 to 0.82911, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-09-0.83.hdf5
 - 26s - loss: 0.4121 - acc: 0.8276 - val_loss: 0.4058 - val_acc: 0.8291
Epoch 10/30

Epoch 00010: val_acc did not improve
 - 25s - loss: 0.4114 - acc: 0.8278 - val_loss: 0.4064 - val_acc: 0.8290
Epoch 11/30

Epoch 00011: val_acc improved from 0.82911 to 0.83159, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-11-0.83.hdf5
 - 26s - loss: 0.4059 - acc: 0.8308 - val_loss: 0.4030 - val_acc: 0.8316
Epoch 12/30

Epoch 00012: val_acc improved from 0.83159 to 0.83327, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-12-0.83.hdf5
 - 26s - loss: 0.4061 - acc: 0.8291 - val_loss: 0.4011 - val_acc: 0.8333
Epoch 13/30

Epoch 00013: val_acc improved from 0.83327 to 0.83338, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-13-0.83.hdf5
 - 26s - loss: 0.4032 - acc: 0.8322 - val_loss: 0.4024 - val_acc: 0.8334
Epoch 14/30

Epoch 00014: val_acc did not improve
 - 25s - loss: 0.4017 - acc: 0.8328 - val_loss: 0.4045 - val_acc: 0.8327
Epoch 15/30

Epoch 00015: val_acc improved from 0.83338 to 0.83364, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-15-0.83.hdf5
 - 26s - loss: 0.3997 - acc: 0.8321 - val_loss: 0.4008 - val_acc: 0.8336
Epoch 16/30

Epoch 00016: val_acc did not improve
 - 25s - loss: 0.3966 - acc: 0.8341 - val_loss: 0.4023 - val_acc: 0.8318
Epoch 17/30

Epoch 00017: val_acc improved from 0.83364 to 0.83448, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-17-0.83.hdf5
 - 26s - loss: 0.3978 - acc: 0.8346 - val_loss: 0.3996 - val_acc: 0.8345
Epoch 18/30

Epoch 00018: val_acc improved from 0.83448 to 0.83538, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-18-0.84.hdf5
 - 26s - loss: 0.3939 - acc: 0.8367 - val_loss: 0.3996 - val_acc: 0.8354
Epoch 19/30

Epoch 00019: val_acc did not improve
 - 26s - loss: 0.3928 - acc: 0.8370 - val_loss: 0.3993 - val_acc: 0.8345
Epoch 20/30

Epoch 00020: val_acc improved from 0.83538 to 0.83585, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-20-0.84.hdf5
 - 26s - loss: 0.3895 - acc: 0.8384 - val_loss: 0.3976 - val_acc: 0.8359
Epoch 21/30

Epoch 00021: val_acc did not improve
 - 26s - loss: 0.3915 - acc: 0.8366 - val_loss: 0.3979 - val_acc: 0.8351
Epoch 22/30

Epoch 00022: val_acc did not improve
 - 25s - loss: 0.3888 - acc: 0.8384 - val_loss: 0.3975 - val_acc: 0.8353
Epoch 23/30

Epoch 00023: val_acc did not improve
 - 26s - loss: 0.3864 - acc: 0.8395 - val_loss: 0.4010 - val_acc: 0.8307
Epoch 24/30

Epoch 00024: val_acc did not improve
 - 25s - loss: 0.3849 - acc: 0.8393 - val_loss: 0.4005 - val_acc: 0.8323
Epoch 25/30

Epoch 00025: val_acc did not improve
 - 26s - loss: 0.3825 - acc: 0.8427 - val_loss: 0.3997 - val_acc: 0.8334
Epoch 26/30

Epoch 00026: val_acc did not improve
 - 25s - loss: 0.3803 - acc: 0.8422 - val_loss: 0.4036 - val_acc: 0.8326
Epoch 27/30

Epoch 00027: val_acc did not improve
 - 26s - loss: 0.3817 - acc: 0.8423 - val_loss: 0.3970 - val_acc: 0.8359
Epoch 28/30

Epoch 00028: val_acc did not improve
 - 26s - loss: 0.3754 - acc: 0.8459 - val_loss: 0.3942 - val_acc: 0.8359
Epoch 29/30

Epoch 00029: val_acc did not improve
 - 26s - loss: 0.3755 - acc: 0.8454 - val_loss: 0.4052 - val_acc: 0.8331
Epoch 30/30

Epoch 00030: val_acc did not improve
 - 25s - loss: 0.3748 - acc: 0.8454 - val_loss: 0.3986 - val_acc: 0.8354
(18995,)
(18995,)
Mean accuracy score:  0.8353777309818373
F1 score: 0.6975529548312216
Recall: 0.6052366565961732
Precision: 0.8230997489157726

 clasification report:
              precision    recall  f1-score   support

          0       0.84      0.94      0.89     13037
          1       0.82      0.61      0.70      5958

avg / total       0.83      0.84      0.83     18995


 confusion matrix:
 [[12262   775]
 [ 2352  3606]]
