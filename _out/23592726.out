Temp data dir is : /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/
Output data dir is: /scratch/users/ali39@jhu.edu/data/dnn/output/2dcnn_fragility_notnorm/
Train data dir is: /scratch/users/ali39@jhu.edu/data/dnn/
0
/scratch/users/ali39@jhu.edu/dnn-unsupervised
Running training model

/scratch/users/ali39@jhu.edu/dnn-unsupervisedCreated VGG12 Style CNN_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 32, 32, 1)         0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 30, 30, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 28, 28, 32)        9248      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 26, 26, 32)        9248      
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 24, 24, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 8, 8, 64)          36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 64)          0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 2, 2, 128)         73856     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 1, 1, 128)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               66048     
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 1026      
=================================================================
Total params: 224,418
Trainable params: 224,418
Non-trainable params: 0
_________________________________________________________________
None
Saved model to disk
None
model input shape is:  (None, 32, 32, 1)
['image_tensor', 'metadata']


 Images and ylabels shapes are: 

(57560, 32, 32, 1)
(57560, 2)


(57560, 32, 32, 1)
Using real-time data augmentation.
Epoch 1/50

Epoch 00001: val_acc improved from -inf to 0.79147, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-01-0.79.hdf5
 - 31s - loss: 0.5312 - acc: 0.7537 - val_loss: 0.4794 - val_acc: 0.7915
Epoch 2/50

Epoch 00002: val_acc improved from 0.79147 to 0.81016, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-02-0.81.hdf5
 - 25s - loss: 0.4656 - acc: 0.8019 - val_loss: 0.4486 - val_acc: 0.8102
Epoch 3/50

Epoch 00003: val_acc did not improve
 - 26s - loss: 0.4448 - acc: 0.8134 - val_loss: 0.4449 - val_acc: 0.8071
Epoch 4/50

Epoch 00004: val_acc improved from 0.81016 to 0.82037, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-04-0.82.hdf5
 - 25s - loss: 0.4325 - acc: 0.8181 - val_loss: 0.4232 - val_acc: 0.8204
Epoch 5/50

Epoch 00005: val_acc improved from 0.82037 to 0.82395, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-05-0.82.hdf5
 - 26s - loss: 0.4268 - acc: 0.8208 - val_loss: 0.4164 - val_acc: 0.8240
Epoch 6/50

Epoch 00006: val_acc improved from 0.82395 to 0.82453, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-06-0.82.hdf5
 - 26s - loss: 0.4197 - acc: 0.8234 - val_loss: 0.4199 - val_acc: 0.8245
Epoch 7/50

Epoch 00007: val_acc did not improve
 - 26s - loss: 0.4182 - acc: 0.8250 - val_loss: 0.4136 - val_acc: 0.8240
Epoch 8/50

Epoch 00008: val_acc improved from 0.82453 to 0.82838, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-08-0.83.hdf5
 - 26s - loss: 0.4128 - acc: 0.8269 - val_loss: 0.4100 - val_acc: 0.8284
Epoch 9/50

Epoch 00009: val_acc did not improve
 - 26s - loss: 0.4122 - acc: 0.8267 - val_loss: 0.4110 - val_acc: 0.8271
Epoch 10/50

Epoch 00010: val_acc did not improve
 - 25s - loss: 0.4071 - acc: 0.8298 - val_loss: 0.4106 - val_acc: 0.8262
Epoch 11/50

Epoch 00011: val_acc improved from 0.82838 to 0.83048, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-11-0.83.hdf5
 - 26s - loss: 0.4074 - acc: 0.8295 - val_loss: 0.4040 - val_acc: 0.8305
Epoch 12/50

Epoch 00012: val_acc improved from 0.83048 to 0.83069, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-12-0.83.hdf5
 - 25s - loss: 0.4054 - acc: 0.8293 - val_loss: 0.4055 - val_acc: 0.8307
Epoch 13/50

Epoch 00013: val_acc did not improve
 - 26s - loss: 0.4051 - acc: 0.8323 - val_loss: 0.4083 - val_acc: 0.8279
Epoch 14/50

Epoch 00014: val_acc improved from 0.83069 to 0.83280, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-14-0.83.hdf5
 - 26s - loss: 0.3998 - acc: 0.8329 - val_loss: 0.4009 - val_acc: 0.8328
Epoch 15/50

Epoch 00015: val_acc improved from 0.83280 to 0.83343, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-15-0.83.hdf5
 - 26s - loss: 0.3982 - acc: 0.8341 - val_loss: 0.4010 - val_acc: 0.8334
Epoch 16/50

Epoch 00016: val_acc did not improve
 - 25s - loss: 0.3985 - acc: 0.8346 - val_loss: 0.4027 - val_acc: 0.8321
Epoch 17/50

Epoch 00017: val_acc improved from 0.83343 to 0.83369, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-17-0.83.hdf5
 - 26s - loss: 0.3975 - acc: 0.8349 - val_loss: 0.3991 - val_acc: 0.8337
Epoch 18/50

Epoch 00018: val_acc improved from 0.83369 to 0.83396, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-18-0.83.hdf5
 - 26s - loss: 0.3912 - acc: 0.8382 - val_loss: 0.3989 - val_acc: 0.8340
Epoch 19/50

Epoch 00019: val_acc improved from 0.83396 to 0.83448, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-19-0.83.hdf5
 - 26s - loss: 0.3933 - acc: 0.8375 - val_loss: 0.3974 - val_acc: 0.8345
Epoch 20/50

Epoch 00020: val_acc did not improve
 - 25s - loss: 0.3907 - acc: 0.8373 - val_loss: 0.3985 - val_acc: 0.8332
Epoch 21/50

Epoch 00021: val_acc did not improve
 - 26s - loss: 0.3878 - acc: 0.8389 - val_loss: 0.4006 - val_acc: 0.8341
Epoch 22/50

Epoch 00022: val_acc did not improve
 - 25s - loss: 0.3892 - acc: 0.8384 - val_loss: 0.3984 - val_acc: 0.8343
Epoch 23/50

Epoch 00023: val_acc did not improve
 - 26s - loss: 0.3855 - acc: 0.8404 - val_loss: 0.3998 - val_acc: 0.8338
Epoch 24/50

Epoch 00024: val_acc did not improve
 - 25s - loss: 0.3834 - acc: 0.8426 - val_loss: 0.4026 - val_acc: 0.8311
Epoch 25/50

Epoch 00025: val_acc did not improve
 - 26s - loss: 0.3825 - acc: 0.8418 - val_loss: 0.4022 - val_acc: 0.8334
Epoch 26/50

Epoch 00026: val_acc improved from 0.83448 to 0.83543, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-26-0.84.hdf5
 - 25s - loss: 0.3815 - acc: 0.8410 - val_loss: 0.3994 - val_acc: 0.8354
Epoch 27/50

Epoch 00027: val_acc did not improve
 - 26s - loss: 0.3791 - acc: 0.8424 - val_loss: 0.4034 - val_acc: 0.8340
Epoch 28/50

Epoch 00028: val_acc did not improve
 - 25s - loss: 0.3777 - acc: 0.8454 - val_loss: 0.3984 - val_acc: 0.8344
Epoch 29/50

Epoch 00029: val_acc did not improve
 - 26s - loss: 0.3763 - acc: 0.8447 - val_loss: 0.4013 - val_acc: 0.8344
Epoch 30/50

Epoch 00030: val_acc did not improve
 - 25s - loss: 0.3752 - acc: 0.8453 - val_loss: 0.4047 - val_acc: 0.8333
Epoch 31/50

Epoch 00031: val_acc did not improve
 - 26s - loss: 0.3705 - acc: 0.8476 - val_loss: 0.4033 - val_acc: 0.8321
Epoch 32/50

Epoch 00032: val_acc did not improve
 - 25s - loss: 0.3703 - acc: 0.8480 - val_loss: 0.4001 - val_acc: 0.8344
Epoch 33/50

Epoch 00033: val_acc did not improve
 - 25s - loss: 0.3679 - acc: 0.8487 - val_loss: 0.4037 - val_acc: 0.8341
Epoch 34/50

Epoch 00034: val_acc did not improve
 - 25s - loss: 0.3662 - acc: 0.8498 - val_loss: 0.3993 - val_acc: 0.8350
Epoch 35/50

Epoch 00035: val_acc did not improve
 - 26s - loss: 0.3681 - acc: 0.8475 - val_loss: 0.4004 - val_acc: 0.8339
Epoch 36/50

Epoch 00036: val_acc did not improve
 - 25s - loss: 0.3610 - acc: 0.8516 - val_loss: 0.4055 - val_acc: 0.8322
Epoch 37/50

Epoch 00037: val_acc improved from 0.83543 to 0.83554, saving model to /scratch/users/ali39@jhu.edu/data/dnn/temp/2dcnn_fragility_notnorm/weights-improvement-37-0.84.hdf5
 - 26s - loss: 0.3624 - acc: 0.8515 - val_loss: 0.4017 - val_acc: 0.8355
Epoch 38/50

Epoch 00038: val_acc did not improve
 - 25s - loss: 0.3583 - acc: 0.8537 - val_loss: 0.4103 - val_acc: 0.8320
Epoch 39/50

Epoch 00039: val_acc did not improve
 - 25s - loss: 0.3590 - acc: 0.8535 - val_loss: 0.4047 - val_acc: 0.8320
Epoch 40/50

Epoch 00040: val_acc did not improve
 - 25s - loss: 0.3530 - acc: 0.8561 - val_loss: 0.4059 - val_acc: 0.8329
Epoch 41/50

Epoch 00041: val_acc did not improve
 - 26s - loss: 0.3515 - acc: 0.8557 - val_loss: 0.4139 - val_acc: 0.8331
Epoch 42/50

Epoch 00042: val_acc did not improve
 - 25s - loss: 0.3502 - acc: 0.8588 - val_loss: 0.4061 - val_acc: 0.8330
Epoch 43/50

Epoch 00043: val_acc did not improve
 - 26s - loss: 0.3479 - acc: 0.8582 - val_loss: 0.4125 - val_acc: 0.8336
Epoch 44/50

Epoch 00044: val_acc did not improve
 - 25s - loss: 0.3451 - acc: 0.8599 - val_loss: 0.4090 - val_acc: 0.8319
Epoch 45/50

Epoch 00045: val_acc did not improve
 - 26s - loss: 0.3424 - acc: 0.8616 - val_loss: 0.4125 - val_acc: 0.8316
Epoch 46/50

Epoch 00046: val_acc did not improve
 - 25s - loss: 0.3415 - acc: 0.8614 - val_loss: 0.4229 - val_acc: 0.8282
Epoch 47/50

Epoch 00047: val_acc did not improve
 - 26s - loss: 0.3388 - acc: 0.8619 - val_loss: 0.4236 - val_acc: 0.8285
Epoch 48/50

Epoch 00048: val_acc did not improve
 - 25s - loss: 0.3366 - acc: 0.8631 - val_loss: 0.4169 - val_acc: 0.8310
Epoch 49/50

Epoch 00049: val_acc did not improve
 - 26s - loss: 0.3349 - acc: 0.8626 - val_loss: 0.4236 - val_acc: 0.8307
Epoch 50/50

Epoch 00050: val_acc did not improve
 - 25s - loss: 0.3319 - acc: 0.8651 - val_loss: 0.4283 - val_acc: 0.8282
(18995,)
(18995,)
Mean accuracy score:  0.8281653066596473
F1 score: 0.690674753601213
Recall: 0.61161463578382
Precision: 0.7932085328689595

 clasification report:
              precision    recall  f1-score   support

          0       0.84      0.93      0.88     13037
          1       0.79      0.61      0.69      5958

avg / total       0.82      0.83      0.82     18995


 confusion matrix:
 [[12087   950]
 [ 2314  3644]]
