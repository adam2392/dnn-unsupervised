Temp data dir is : /scratch/users/ali39@jhu.edu/data/dnn/temp/test_2dcnn_fragility_notnorm/
Output data dir is: /scratch/users/ali39@jhu.edu/data/dnn/output/test_2dcnn_fragility_notnorm/
Train data dir is: /scratch/users/ali39@jhu.edu/data/dnn/
3
/scratch/users/ali39@jhu.edu/dnn-unsupervised
Running training model

/scratch/users/ali39@jhu.edu/dnn-unsupervisedCreated VGG12 Style CNN_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 32, 32, 1)         0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 30, 30, 32)        320       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 28, 28, 32)        9248      
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 26, 26, 32)        9248      
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 24, 24, 32)        9248      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 8, 8, 64)          36928     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 4, 4, 64)          0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 2, 2, 128)         73856     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 1, 1, 128)         0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 128)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 512)               66048     
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 1026      
=================================================================
Total params: 224,418
Trainable params: 224,418
Non-trainable params: 0
_________________________________________________________________
None
Saved model to disk
None
model input shape is:  (None, 32, 32, 1)
['image_tensor', 'metadata']


 Images and ylabels shapes are: 

(57560, 32, 32, 1)
(57560, 2)


(57560, 32, 32, 1)
Using real-time data augmentation.
Epoch 1/30
 - 30s - loss: 0.5318 - acc: 0.7541 - val_loss: 0.7619 - val_acc: 0.4413
Epoch 2/30
 - 24s - loss: 0.4625 - acc: 0.8051 - val_loss: 0.7901 - val_acc: 0.4112
Epoch 3/30
 - 24s - loss: 0.4413 - acc: 0.8138 - val_loss: 0.7717 - val_acc: 0.4235
Epoch 4/30
 - 24s - loss: 0.4309 - acc: 0.8175 - val_loss: 0.8795 - val_acc: 0.4126
Epoch 5/30
 - 24s - loss: 0.4256 - acc: 0.8214 - val_loss: 0.7943 - val_acc: 0.4541
Epoch 6/30
 - 24s - loss: 0.4213 - acc: 0.8238 - val_loss: 0.8163 - val_acc: 0.4306
Epoch 7/30
 - 24s - loss: 0.4176 - acc: 0.8248 - val_loss: 0.8613 - val_acc: 0.4347
Epoch 8/30
 - 24s - loss: 0.4149 - acc: 0.8248 - val_loss: 0.7868 - val_acc: 0.4484
Epoch 9/30
 - 24s - loss: 0.4125 - acc: 0.8274 - val_loss: 0.8432 - val_acc: 0.4415
Epoch 10/30
 - 24s - loss: 0.4095 - acc: 0.8286 - val_loss: 0.8518 - val_acc: 0.4310
Epoch 11/30
 - 24s - loss: 0.4080 - acc: 0.8285 - val_loss: 0.8897 - val_acc: 0.4444
Epoch 12/30
 - 24s - loss: 0.4065 - acc: 0.8300 - val_loss: 0.8519 - val_acc: 0.4523
Epoch 13/30
 - 24s - loss: 0.4045 - acc: 0.8306 - val_loss: 0.8341 - val_acc: 0.4604
Epoch 14/30
 - 24s - loss: 0.4031 - acc: 0.8315 - val_loss: 0.8157 - val_acc: 0.4535
Epoch 15/30
 - 24s - loss: 0.4023 - acc: 0.8328 - val_loss: 0.8956 - val_acc: 0.4369
Epoch 16/30
 - 24s - loss: 0.3990 - acc: 0.8342 - val_loss: 0.8731 - val_acc: 0.4454
Epoch 17/30
 - 24s - loss: 0.3981 - acc: 0.8338 - val_loss: 0.8991 - val_acc: 0.4395
Epoch 18/30
 - 24s - loss: 0.3972 - acc: 0.8349 - val_loss: 0.8510 - val_acc: 0.4547
Epoch 19/30
 - 24s - loss: 0.3956 - acc: 0.8342 - val_loss: 0.8375 - val_acc: 0.4585
Epoch 20/30
 - 24s - loss: 0.3949 - acc: 0.8350 - val_loss: 0.8968 - val_acc: 0.4426
Epoch 21/30
 - 24s - loss: 0.3934 - acc: 0.8366 - val_loss: 0.9484 - val_acc: 0.4244
Epoch 22/30
 - 24s - loss: 0.3925 - acc: 0.8355 - val_loss: 0.8976 - val_acc: 0.4462
Epoch 23/30
 - 24s - loss: 0.3918 - acc: 0.8379 - val_loss: 0.8566 - val_acc: 0.4602
Epoch 24/30
 - 24s - loss: 0.3911 - acc: 0.8371 - val_loss: 0.9128 - val_acc: 0.4630
Epoch 25/30
 - 24s - loss: 0.3889 - acc: 0.8380 - val_loss: 0.8821 - val_acc: 0.4462
Epoch 26/30
 - 24s - loss: 0.3887 - acc: 0.8384 - val_loss: 0.8822 - val_acc: 0.4593
Epoch 27/30
 - 24s - loss: 0.3871 - acc: 0.8401 - val_loss: 0.8619 - val_acc: 0.4676
Epoch 28/30
 - 24s - loss: 0.3872 - acc: 0.8408 - val_loss: 0.8647 - val_acc: 0.4743
Epoch 29/30
 - 24s - loss: 0.3856 - acc: 0.8406 - val_loss: 0.8699 - val_acc: 0.4660
Epoch 30/30
 - 24s - loss: 0.3831 - acc: 0.8408 - val_loss: 0.9044 - val_acc: 0.4417
(4944,)
(4944,)
Mean accuracy score:  0.441747572815534
F1 score: 0.5805471124620061
Recall: 0.9394982784062961
Precision: 0.4200571805586101

 clasification report:
              precision    recall  f1-score   support

          0       0.69      0.09      0.17      2911
          1       0.42      0.94      0.58      2033

avg / total       0.58      0.44      0.34      4944


 confusion matrix:
 [[ 274 2637]
 [ 123 1910]]
